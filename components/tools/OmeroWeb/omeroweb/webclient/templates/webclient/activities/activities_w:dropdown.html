						<!-- Result of script -->
                        <td class="results">
                            

							<!-- Drop Down -->
                            {% for k,v in j.results.iteritems %}
                                <div>
                                    {% if v.type and v.id %}
                                        <span class="dropdown_menu">
                                        <!-- Handle robjects, E.g. ImageI, FileAnnotation etc -->
                                        <span class="menu_launch" title="Script Result: '{{ k }}'">
                                        {% if v.name %} {{ v.name|truncatebefor:"30" }} {% else %} {{ v.type }} ID: {{ v.id }} {% endif %}
                                        </span>
                                            <ul class="dropdown_menu_options">
                                                {% if v.browse_url %}
                                                    <li><a href='{{ v.browse_url}}' class='browse' title="Navigate to {{ v.type }} in the main window">
                                                        Go to {% ifequal v.type "FileAnnotation" %} Attachment {% else %} {{ v.type }} {% endifequal %}
                                                    </a></li>
                                                {% endif %}

                                                {% ifequal v.type "FileAnnotation" %}
                                                    <li><a href="{% url download_annotation 'download' v.id %}" title="Download File">
                                                        Download
                                                    </a></li>
                                                    {% if v.fileId %}
                                                        <li><a href="#" onClick="return openPopup('{% url get_original_file v.fileId %}');">View {{ v.fileType }}</a></li>
                                                    {% endif %}
                                                {% else %}
                                                    {% ifequal v.type "Image" %}
                                                        <li><a href="#" onClick="return openPopup('{% url webgateway.views.full_viewer v.id %}');" title="Open Image in Viewer">
                                                            View Image
                                                        </a></li>
                                                    {% endifequal %}
                                                {% endifequal %}

                                                <!-- add stderr and stdout to first result only -->
                                                {% if forloop.first %}
                                                    {% if j.stderr %}
                                                        <li><a href="#" onClick="return openPopup('{% url get_original_file j.stderr %}');"
                                                            title="Show error produced by the script">
                                                            Error
                                                        </a></li>
                                                    {% endif %}
                                                    {% if j.stdout %}
                                                        <li><a href="#" onClick="return openPopup('{% url get_original_file j.stdout %}');" 
                                                            title="Show additional info generated by the script">
                                                            Info
                                                        </a></li>
                                                    {% endif %}
                                                {% endif %}
                                            </ul>
                                        </span>
                                    {% else %}
                                        <!-- Handle rtypes (already unwrapped) -->
                                        <span title="Script Result: '{{ k }}'">
                                        {{ v }}
                                        </span>
                                    {% endif %}
                                </div>
                            {% endfor %}


                            <!-- if there were no results items, we have to display info and error here -->
                            {% if not j.results %}
                                <div class="error" style='float:left'>
                                    {% if j.stderr %}<a href="#" onClick="return openPopup('{% url get_original_file j.stderr %}');">Error</a>{% endif %}
                                </div>
                                <div class="info">
                                    {% if j.stdout %}<a href="#" onClick="return openPopup('{% url get_original_file j.stdout %}');">Info</a>{% endif %}
                                </div>
                            {% endif %}
                        </td>
