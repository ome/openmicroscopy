*** Settings ***

Documentation     A test suite with a single test for valid login.
...
...               This test has a workflow that is created using keywords in
...               the imported resource file.
Resource          ../../../../resources/omeroweb/resource.txt

*** Variables ***

${WEBADMIN URL}     http://${WEBSERVER}/webadmin/experimenters/

${CREATE NEW USER URL}     http://${WEBSERVER}/webadmin/experimenters/

*** Test Cases ***

Check Group Form
    [Documentation]     Tests elements on the create group page

    Open Browser To Webadmin Login Page
    Log In As Root
    Page Should Be Open    ${WEBADMIN URL}
    Click Link    link=Groups
    Click Link    link=Add new Group
    
    Page Should Contain    Add group
    Page Should Contain    Fields marked in red are mandatory.
    
    Page Should Contain    Name
    Page Should Contain Textfield    name=name
    Page Should Contain    Description
    Page Should Contain Textfield    name=description
    
    Page Should Contain    Owners
    Page Should Contain Textfield    Choose one or more owners
    Page Should Contain    Members
    Page Should Contain Textfield    Choose one or more members
    
    Page Should Contain    Permissions
    Page Should Contain Radio Button    permissions
    Radio Button Should Be Set To    permissions    0
    
    Page Should Contain    Private
    Page Should Contain    Read-Only
    Page Should Contain    Read-Annotate
    
    Page Should Contain Button    Save
    
    Page Should Contain Link    OMERO Permissions
    
    Log Out
    [Teardown]    Close Browser


Check User Form
    [Documentation]     Tests elements on the create user page
    
    Open Browser To Webadmin Login Page
    Log In As Root
    Page Should Be Open    ${WEBADMIN URL}
    Click Link    link=Add new User
    
    Page Should Contain    New User
    Page Should Contain    Fields marked in red are mandatory.
    
    Page Should Contain    Username
    Page Should Contain Textfield    name=omename
    Page Should Contain    Password
    Page Should Contain Element    name=password
    Page Should Contain    Confirmation
    Page Should Contain Element    name=confirmation
    Page Should Contain    First name
    Page Should Contain Textfield    name=first_name
    Page Should Contain    Middle name
    Page Should Contain Textfield    name=middle_name
    Page Should Contain    Last name
    Page Should Contain Textfield    name=last_name
    Page Should Contain    Email
    Page Should Contain Textfield    name=email
    Page Should Contain    Institution
    Page Should Contain Textfield    name=institution
    
    Page Should Contain    Administrator
    Page Should Contain Checkbox    administrator
    Checkbox Should Not Be Selected    administrator
    Page Should Contain    Active
    Page Should Contain Checkbox    active
    Checkbox Should Be Selected    active
    
    Page Should Contain    Group
    Page Should Contain Textfield    Choose one or more groups
    
    Page Should Contain Button    Save
    
    Log Out
    [Teardown]    Close Browser


Create Group
    [Documentation]     Tests group creation
    
    Open Browser To Webadmin Login Page
    Log In As Root
    Page Should Be Open    ${WEBADMIN URL}
    Click Link    link=Groups
    Click Link    link=Add new Group
    
    ${group_name}    Unique name    test_group
    
    Input Text    name    ${group_name}
    Input Text    description    This is test group
    Select Radio Button    permissions    1
    
    Click Button    Save
    
    Click Link    link=Users
    
    Click Link    link=Add new User
    
    ${user_name}    Unique name    test_user
    Input Text    omename    ${user_name}
    Input Text    password    ${user_name}
    Input Text    confirmation    ${user_name}
    Input Text    first_name    ${user_name}
    Input Text    middle_name    ${user_name}
    Input Text    last_name    ${user_name}
    Input Text    institution    ${user_name}
    
    Click Element    xpath=//ul[@class='chzn-choices']
    Page Should Contain Element    xpath=//ul[@class='chzn-results']
    Click Element    xpath=//ul[@class='chzn-results']/li[contains(text(),'${group_name}')]
    
    Click Button    Save
    
    Log Out
    [Teardown]    Close Browser
